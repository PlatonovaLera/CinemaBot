import telebot
from telebot import types
import csv
import random

line_count = sum(1 for line in open(r'C:\Users\–î–∞—à–∞\Desktop\2 –∫—É—Ä—Å\pythonProject\–±–¥ csv.csv')) - 1 #—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª-–≤–æ —Å—Ç—Ä–æ–∫ –≤ –±–¥
#print(line_count)

def rand_film_name():
    rand_num_of_film = random.randint(1, line_count)
    with open(r'C:\Users\–î–∞—à–∞\Desktop\2 –∫—É—Ä—Å\pythonProject\–±–¥ csv.csv', newline='') as csvfile:
        reader = csv.reader(csvfile)
        for i in range(rand_num_of_film):
            row = next(reader)   # —á–∏—Ç–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–æ–∫—É
        row = next(reader)
        return row[0]

bot = telebot.TeleBot('6969036206:AAFrWpg8FYYCxUr8rTtOq_YmzajlM4n6WJU')

@bot.message_handler(commands=['start'])
def start(message):
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    btn1 = types.KeyboardButton('–ü–æ–¥–±–æ—Ä–∫–∞ —Ñ–∏–ª—å–º–æ–≤')
    btn2 = types.KeyboardButton('–ü–æ–¥–±–æ—Ä–∫–∞ —Å–µ—Ä–∏–∞–ª–æ–≤')
    btn3 = types.KeyboardButton('–°–ª—É—á–∞–π–Ω—ã–π —Ñ–∏–ª—å–º')
    btn4 = types.KeyboardButton('–°–ª—É—á–∞–π–Ω—ã–π —Å–µ—Ä–∏–∞–ª')
    markup.row(btn1, btn2)
    markup.row(btn3, btn4)
    bot.send_message(message.chat.id, f'–ü—Ä–∏–≤–µ—Ç, {message.from_user.username}! –í—ã–±–µ—Ä–∏, —á—Ç–æ —Ç—ã —Ö–æ—á–µ—à—å —Å–¥–µ–ª–∞—Ç—å üëáüèª', reply_markup=markup)
    bot.register_next_step_handler(message, on_click)

def on_click(message):
    if message.text == '–ü–æ–¥–±–æ—Ä–∫–∞ —Ñ–∏–ª—å–º–æ–≤':
        #bot.register_next_step_handler(message, on_click_list_of_films)
        bot.send_message(message.chat.id, '–í—ã –≤—ã–±—Ä–∞–ª–∏ –ø–æ–¥–±–æ—Ä–∫—É —Ñ–∏–ª—å–º–æ–≤')
    elif message.text == '–ü–æ–¥–±–æ—Ä–∫–∞ —Å–µ—Ä–∏–∞–ª–æ–≤':
        #bot.register_next_step_handler(message, on_click_list_of_series)
        bot.send_message(message.chat.id, '–í—ã –≤—ã–±—Ä–∞–ª–∏ –ø–æ–¥–±–æ—Ä–∫—É —Å–µ—Ä–∏–∞–ª–æ–≤')
    elif message.text == '–°–ª—É—á–∞–π–Ω—ã–π —Ñ–∏–ª—å–º':
        random_film = rand_film_name()
        bot.send_message(message.chat.id, f"–í–æ—Ç –≤–∞—à —Å–ª—É—á–∞–π–Ω—ã–π —Ñ–∏–ª—å–º: {random_film}")
        #bot.send_message(message.chat.id, '–í—ã –≤—ã–±—Ä–∞–ª–∏ —Å–ª—É—á–∞–π–Ω—ã–π —Ñ–∏–ª—å–º')
        #bot.register_next_step_handler(message, on_click_random_film)
    elif message.text == '–°–ª—É—á–∞–π–Ω—ã–π —Å–µ—Ä–∏–∞–ª':
        bot.send_message(message.chat.id, '–í—ã –≤—ã–±—Ä–∞–ª–∏ —Å–ª—É—á–∞–π–Ω—ã–π —Å–µ—Ä–∏–∞–ª')
        #bot.register_next_step_handler(message, on_click_random_series)

def on_click_random_film(message):
    random_film = rand_film_name()  # –ó–∞–º–µ–Ω–∏—Ç–µ —ç—Ç–æ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ñ–∏–ª—å–º–∞
    bot.send_message(message.chat.id, f"–í–æ—Ç –≤–∞—à —Å–ª—É—á–∞–π–Ω—ã–π —Ñ–∏–ª—å–º: {random_film}")
